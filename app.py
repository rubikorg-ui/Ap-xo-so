Tôi gửi kèm file `app.py`. Đây là ứng dụng soi cầu xổ số viết bằng Streamlit. Hiện tại file này đang gặp vấn đề nghiêm trọng về việc đọc dữ liệu từ Excel/CSV (lỗi không đọc được nhiều Sheet, lỗi sai ngày tháng khi chuyển năm 2025-2026, lỗi nhập liệu).

Nhiệm vụ của bạn:
Hãy sửa file `app.py` này bằng cách **THAY THẾ TOÀN BỘ** phần "CORE FUNCTIONS" cũ bằng 4 hàm mới đã được tối ưu dưới đây.

⚠️ YÊU CẦU BẮT BUỘC (TUYỆT ĐỐI TUÂN THỦ):
1. **Giữ nguyên 100%** các phần code khác (Giao diện Streamlit, Logic tính toán soi cầu, Backtest, Matrix...). KHÔNG ĐƯỢC thêm bớt tính năng hay sửa đổi logic toán học.
2. Chỉ sửa đúng các hàm xử lý dữ liệu (Data Loading) để fix lỗi.
3. Code trả về phải là **Full Code** hoàn chỉnh, tôi có thể copy đè vào file cũ chạy luôn.
